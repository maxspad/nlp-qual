make_dataset:
  masterdb_path: data/raw/masterdbFromRobMac.xlsx
  mac_path: data/raw/mcmaster-database-de-identified-comments.xlsx
  sas_path: data/raw/sask-database-de-identified-comments.xlsx
  output_path: data/interim/masterdbForNLP.xlsx
  q1_condense: True
  q1_condense_col_name: Q1c
  q2_invert: True
  q2_invert_col_name: Q2i
  q3_invert: True
  q3_invert_col_name: Q3i
  qual_condense: True
  qual_condense_col_name: QUALc

proc_spacy:
  dataset_path: ${make_dataset.output_path}
  output_path: data/interim/masterdbForNLPSpacyProc.pkl
  text_var: comment
  spacy_model: en_core_web_sm
  spacy_procs: 4
  progress_bar: True

split_train_test:
  dataset_path: ${proc_spacy.output_path}
  output_dir: data/processed
  train_path: ${split_train_test.output_dir}/train.pkl
  test_path: ${split_train_test.output_dir}/test.pkl
  test_size: 0.15
  random_state: 43
  train_file_name: train.pkl
  test_file_name: test.pkl

train:
  mlflow_dir: mlruns
  conda_yaml_path: './conda.yaml'
  mlflow_tracking_dir: ./mlruns
  mlflow_experiment_name: ${train.target_var}_manual
  train_path: ${split_train_test.train_path}
  text_var: ${proc_spacy.text_var}_spacy
  target_var: QUALc
  invert_target: True
  random_seed: 43
  punct: True
  pron: True
  stop: False
  lemma: False
  ngram_min: 1
  ngram_max: 2
  max_df: 1.0
  min_df: 1
  token_count: True
  pos_counts: False
  ent_counts: False
  vectors: False
  model_c: 0.01
  max_iter: 10000
  class_weight: 'balanced'

  # only applies if training QUAL
  q1_mlflow_exp_name: 220812_123209_q1_10000t_random
  q1_mlflow_run_id: 059651b7006d4e0099fdf410fad12532
  q2_mlflow_exp_name: hparam_simplification
  q2_mlflow_run_id: 8a2417c0ca784c12a4cccd8abca64a58
  q3_mlflow_exp_name: 220809_102311_Q3_1000t_rand_inv
  q3_mlflow_run_id: 9598a48f12ef4e11b0be907cbe4eb898
  qual_text_mlflow_exp_name: QUAL_manual
  qual_text_mlflow_run_id: e1a1cb95017a499b81f2335c0733ec48
  qual_fit_type: 'simultaneous' # text_only/submodels_only/simultaneous/text_first
  

test:
  mlflow_dir: ${train.mlflow_dir}
  mlflow_source_experiment_name: 220816_141727_QUAL_textonly_1000t
  mlflow_run_id: 7d2a1247779e412291bf73d31ba6fb47
  test_path: ${split_train_test.test_path}
  target_var: ${train.target_var}
  invert_target: ${train.invert_target}
  mlflow_target_experiment_name: ${train.target_var}_test
  conda_yaml_path: ${train.conda_yaml_path}
  posthoc: False
  n_top: 15

defaults:
  - override hydra/sweeper: optuna
  - override hydra/sweeper/sampler: random
  - override hydra/launcher: joblib
  - override hydra/job_logging: colorlog
  - override hydra/hydra_logging: colorlog

hydra:
  sweeper:
    sampler:
      seed: 43
    direction: maximize
    study_name: test_study
    storage: null
    n_trials: 250
    n_jobs: 14
    params:
      train.mlflow_experiment_name: sweep_random_100_test_yes_vectors
      train.model_c: choice(1,0.1,0.01,0.001,0.0001)
      train.punct: choice(True, False)
      train.pron: choice(True, False)
      train.stop: choice(True, False)
      train.lemma: choice(True, False)
      train.ngram_min: 1
      train.ngram_max: range(1,8)
      train.max_df: interval(0.1, 1.0)
      train.min_df: range(1,30)
      train.token_count: choice(True, False)
      train.pos_counts: choice(True, False)
      train.ent_counts: choice(True, False)
      train.vectors: choice(True, False)
      train.class_weight: balanced,null





